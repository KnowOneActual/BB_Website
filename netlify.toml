[[headers]]
  for = "/*"
  [headers.values]
    # This is the full Content Security Policy, combining all your rules into one line.
    # It includes all the sources from your old _headers file, plus the one for Turnstile.
    Content-Security-Policy = "default-src 'self' https://www.google.com https://www.gstatic.com https://fonts.googleapis.com https://fonts.gstatic.com https://cdn.tailwindcss.com https://www.soundhelix.com https://cataas.com https://via.placeholder.com https://cdnjs.cloudflare.com; script-src 'self' 'unsafe-inline' https://www.google.com https://www.gstatic.com https://cdn.tailwindcss.com https://cdnjs.cloudflare.com https://challenges.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; img-src 'self' data: https://cataas.com https://via.placeholder.com; font-src 'self' https://fonts.gstatic.com; form-action 'self'; frame-src https://www.google.com; media-src 'self' https://www.soundhelix.com; frame-ancestors 'none';"

    # HTTP Strict Transport Security (HSTS): Forces browsers to use HTTPS for your site.
    Strict-Transport-Security = "max-age=31536000; includeSubDomains; preload"

    # X-Content-Type-Options: Prevents MIME-sniffing attacks.
    X-Content-Type-Options = "nosniff"

    # Referrer-Policy: Controls how much referrer information is sent with requests.
    Referrer-Policy = "no-referrer-when-downgrade"

    # Permissions-Policy (formerly Feature-Policy): Allows you to selectively enable/disable browser features.
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"